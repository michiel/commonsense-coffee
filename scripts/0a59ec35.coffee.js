(function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}},c=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};a=function(){function a(a){var c,d,e;for(null==a&&(a={}),this.log=b(this.log,this),d=0,e=a.length;e>d;d++)c=a[d],this[c]=a[c];$.ajaxSetup({type:"POST",dataType:"json",crossDomain:!0,contentType:"application/json; charset=UTF-8"})}var d;return a.prototype.serverType="live",a.prototype.serverUrl="https://api.sense-os.nl",a.prototype.sessionId=null,a.prototype.verbose=!0,d={live:"https://api,sense-os.nl",dev:"http://api.dev.sense-os.nl",rc:"http://api.rc.dev.sense-os.nl"},a.prototype.authenticateSessionId=function(a,b,c,d){var e,f,g=this;return e=CryptoJS.MD5(b).toString(),f={username:a,password:e},this.sense_api("POST","/login.json",f,function(a){return g.log("login ok : id "+a.session_id),g.sessionId=a.session_id,c?c(a):void 0},function(a){return g.log("login not ok"),d?d(a):void 0})},a.prototype.logoutSessionId=function(a,b){var c=this;return this.sense_api("POST","/@logout.json",{},function(b){return c.log("logout ok"),c.sessionId=null,a?a(b):void 0},function(a){return c.log("logout not ok"),b?b(a):void 0})},a.prototype.setServer=function(a){return c.call(d,a)>=0?(this.serverType=a,this.serverUrl=d[a]):this.log("Invalid server type "+a+" passed")},a.prototype.get=function(a,b,c,d){return this.sense_api("GET","/"+a+"s/"+b+".json",{},c,d)},a.prototype.getAll=function(a,b,c){return this.sense_api("GET","/"+a+"s.json",{},b,c)},a.prototype.sense_api=function(a,b,c,d,e){var f=this;if(null==c&&(c={}),null==d&&(d=function(){}),null==e&&(e=function(){}),!this.sessionId&&"/login.json"!==b)throw new Error("No valid session! Login first or wait for login to complete!");return $.ajax({type:a,url:""+this.serverUrl+b,data:JSON.stringify(c),success:d,error:e,beforeSend:function(a){return""!==f.sessionId?a.setRequestHeader("X-SESSION_ID",f.sessionId):void 0}})},a.prototype.log=function(a){return this.verbose?console.log(a):void 0},a}(),window.SenseApi=a}).call(this),function(){var a;a=function(a,b){var c;return c=new SenseApi,c.authenticateSessionId(a,b,function(){return logme("AUTH OK, fetching sensors ..."),c.getAll("sensor",function(a){var b,d,e,f,g;for(logme("Received "+a.sensors.length+" sensors, fetching individually by ID ..."),f=a.sensors,g=[],d=0,e=f.length;e>d;d++)b=f[d],g.push(c.get("sensor",b.id,function(a){return logme("Sensor "+a.sensor.id+" is called "+a.sensor.name)}));return g})},function(){return logme("AUTH FAILED, aborting  ...")})},$(function(){return $("#submit").click(function(b){return logme("Doing stuff ..."),b.preventDefault(),a($("input[name=username]")[0].value,$("input[name=password]")[0].value),!1})}),window.logme=function(a){return $("#log").append($("<li>").text(a))},$(function(){return logme("Loaded and ready to go .. fill in your api.sense-os.nl details to the left ...")})}.call(this);